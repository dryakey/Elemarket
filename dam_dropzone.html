<!DOCTYPE html>

<!--[if IE 8]> <html lang="en" class="ie8"> <![endif]-->

<!--[if IE 9]> <html lang="en" class="ie9"> <![endif]-->

<!--[if !IE]><!-->
<html lang="en">
	<!--<![endif]-->

	<!-- BEGIN HEAD -->

	<head>

		<meta charset="utf-8" />

		<title>内部信息管理系统</title>

		<meta content="width=device-width, initial-scale=1.0" name="viewport" />

		<meta content="" name="description" />

		<meta content="" name="author" />

		<!-- BEGIN GLOBAL MANDATORY STYLES -->
		<link href="media/css/bootstrap.min.css" rel="stylesheet" media="screen">

		<link href="css/bootstrap-datetimepicker.min.css" rel="stylesheet" media="screen">

		<link href="media/css/bootstrap.min.css" rel="stylesheet" type="text/css" />

		<link href="media/css/bootstrap-responsive.min.css" rel="stylesheet" type="text/css" />

		<!--<link href="media/css/bootstrap-datetimepicker.min.css" rel="stylesheet">-->
		<!--<link rel="stylesheet" href="media/css/bootstrap-datetimepicker.min.css" rel="text/css">-->

		<link href="media/css/font-awesome.min.css" rel="stylesheet" type="text/css" />

		<link href="media/css/style-metro.css" rel="stylesheet" type="text/css" />

		<link href="media/css/style.css" rel="stylesheet" type="text/css" />

		<link href="media/css/style-responsive.css" rel="stylesheet" type="text/css" />

		<link href="media/css/default.css" rel="stylesheet" type="text/css" id="style_color" />

		<link href="media/css/uniform.default.css" rel="stylesheet" type="text/css" />

		<!-- END GLOBAL MANDATORY STYLES -->

		<!-- BEGIN PAGE LEVEL STYLES -->

		<link href="media/css/dropzone.css" rel="stylesheet" />

		<link href="media/css/jquery.fancybox.css" rel="stylesheet" />


		<!--<link href="media/css/jquery-ui.min.css" rel="stylesheet" />

		<!--<link href="media/css/jquery-ui-timepicker-addon.min.css" rel="stylesheet" />-->

		<link rel="stylesheet" type="text/css" href="media/css/datepicker.css" />

		<link href="media/css/glyphicons.css" rel="stylesheet" />
		<link href="media/css/halflings.css" rel="stylesheet" />
		<link rel="shortcut icon" href="media/image/favicon.ico" />

		<!-- END PAGE LEVEL STYLES -->

		<link rel="shortcut icon" href="media/image/favicon.ico" />

	</head>

	<!-- END HEAD -->

	<!-- BEGIN BODY -->

	<body class="page-header-fixed">

		<!-- BEGIN HEADER -->

		<div class="header navbar navbar-inverse navbar-fixed-top">

			<!-- BEGIN TOP NAVIGATION BAR -->

			<div class="navbar-inner">

				<div class="container-fluid">

					<!-- BEGIN LOGO -->

					<a class="brand" href="index.html">

						<img src="media/image/logo.png" alt="logo" />

					</a>

					<!-- END LOGO -->

					<!-- BEGIN RESPONSIVE MENU TOGGLER -->

					<a href="javascript:;" class="btn-navbar collapsed" data-toggle="collapse" data-target=".nav-collapse">

						<img src="media/image/menu-toggler.png" alt="" />

					</a>

					<!-- END RESPONSIVE MENU TOGGLER -->

					<!-- BEGIN TOP NAVIGATION MENU -->

					<ul class="nav pull-right">


						<!-- BEGIN USER LOGIN DROPDOWN -->

						<li class="dropdown user">

							<a href="#" class="dropdown-toggle" data-toggle="dropdown">

								<img alt="" src="media/image/avatar1_small.jpg" />

								<span class="username">吴科俊</span>

								<i class="icon-angle-down"></i>

							</a>

							<ul class="dropdown-menu">

								<!--
						<li><a href="extra_profile.html"><i class="icon-user"></i> My Profile</a></li>
				
						<li><a href="page_calendar.html"><i class="icon-calendar"></i> My Calendar</a></li>
				
						<li><a href="inbox.html"><i class="icon-envelope"></i> My Inbox(3)</a></li>
				
						<li><a href="#"><i class="icon-tasks"></i> My Tasks</a></li>
				
						<li class="divider"></li>
						-->

								<li><a href="lock.html"><i class="icon-lock"></i> 锁定账号</a></li>

								<li><a href="login.html"><i class="icon-key"></i> 登出系统</a></li>

							</ul>

						</li>
						<!-- END USER LOGIN DROPDOWN -->

					</ul>

					<!-- END TOP NAVIGATION MENU -->

				</div>

			</div>

			<!-- END TOP NAVIGATION BAR -->

		</div>

		<!-- END HEADER -->

		<!-- BEGIN CONTAINER -->

		<div class="page-container row-fluid">

			<!-- BEGIN SIDEBAR -->

			<div class="page-sidebar nav-collapse collapse">

				<!-- BEGIN SIDEBAR MENU -->

				<ul class="page-sidebar-menu">

					<li>

						<!-- BEGIN SIDEBAR TOGGLER BUTTON -->

						<div class="sidebar-toggler hidden-phone"></div>

						<!-- BEGIN SIDEBAR TOGGLER BUTTON -->

					</li>

					<li>

						<!-- BEGIN RESPONSIVE QUICK SEARCH FORM -->

						<form class="sidebar-search">

							<div class="input-box">

								<a href="javascript:;" class="remove"></a>

								<input type="text" placeholder="搜索……" />

								<input type="button" class="submit" value=" " />

							</div>

						</form>

						<!-- END RESPONSIVE QUICK SEARCH FORM -->

					</li>

					<li>

						<a href="index.html">

							<i class="icon-home"></i>

							<span class="title">主页</span>
							<span class="selected"></span>

						</a>

					</li>

					<li class="active">

						<a class="active" href="java:;">

							<i class="icon-sitemap"></i>

							<span class="title">日前市场</span>

							<span class="arrow "></span>

						</a>

						<ul class="sub-menu">

							<li>

								<a href="javascript:;">

									日前市场报表

									<span class="arrow"></span>

								</a>

								<ul class="sub-menu">

									<li><a href="dam_day.html">最新日报</a></li>

									<li><a href="dam_week.html">最新周报</a></li>

									<li><a href="dam_month.html">最新月报</a></li>

									<li><a href="dam_his.html">历史报表</a></li>

								</ul>

							</li>

							<li class="active">

								<a href="dam_dropzone.html">

									日前市场数据上传

								</a>

							</li>

						</ul>

					</li>

					<li>

						<a class="active" href="javascript:;">

							<i class="icon-sitemap"></i>

							<span class="title">实时市场</span>

							<span class="arrow "></span>

						</a>

						<ul class="sub-menu">

							<li>

								<a href="javascript:;">

									实时市场报表

									<span class="arrow"></span>

								</a>

								<ul class="sub-menu">

									<li><a href="rm_day.html">最新日报</a></li>

									<li><a href="rm_week.html">最新周报</a></li>

									<li><a href="rm_month.html">最新月报</a></li>

									<li><a href="rm_his.html">历史报表</a></li>

								</ul>

							</li>

							<li>

								<a href="rm_dropzone.html">

									实时市场数据上传

								</a>

							</li>

						</ul>

					</li>

					<li>

						<a href="faq.html">

							<i class="icon-gift"></i>

							<span class="title">帮助</span>
							<span class="selected"></span>

						</a>

					</li>

				</ul>

				<!-- END SIDEBAR MENU -->

			</div>

			<!-- END SIDEBAR -->

			<!-- BEGIN PAGE -->

			<div class="page-content">

				<!-- BEGIN SAMPLE PORTLET CONFIGURATION MODAL FORM-->

				<div id="portlet-config" class="modal hide">

					<div class="modal-header">

						<button data-dismiss="modal" class="close" type="button"></button>

						<h3>portlet Settings</h3>

					</div>

					<div class="modal-body">

						<p>Here will be a configuration form</p>

					</div>

				</div>

				<!-- END SAMPLE PORTLET CONFIGURATION MODAL FORM-->

				<!-- BEGIN PAGE CONTAINER-->

				<div class="container-fluid">

					<!-- BEGIN PAGE HEADER-->

					<div class="row-fluid">

						<div class="span12">


							<!-- BEGIN PAGE TITLE & BREADCRUMB-->

							<h3 class="page-title">

								日前市场数据上传 <small>日前市场数据在下方上传</small>

							</h3>

							<ul class="breadcrumb">

								<li>

									<i class="icon-home"></i>

									<a href="index.html">主页</a>

									<i class="icon-angle-right"></i>

								</li>

								<li>

									<a href="dam_list.html">日前市场报表</a>

									<i class="icon-angle-right"></i>

								</li>

								<li><a href="dam_dropzone.html">日前市场数据上传</a></li>

							</ul>

							<!-- END PAGE TITLE & BREADCRUMB-->

						</div>

					</div>

					<!-- END PAGE HEADER-->

					<!-- BEGIN PAGE CONTENT-->

					<div class="row-fluid">
						<form action="" class="form-horizontal" role="form">
							<fieldset>
								<div class="form-inline">
									<div class="col-lg-6">
										<label for="dtp_input2" class="col-md-2 control-label">选择申报日期</label>
										<div class="input-group date form_date col-md-5" data-date="" data-date-format="dd MM yyyy" data-link-field="dtp_input2"
										 data-link-format="yyyy-mm-dd">
											<input class="form-control" size="22" type="text" value="" readonly>
											<span class="input-group-addon"><span class="glyphicon glyphicon-remove"></span></span>
											<span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
										</div>
										<input type="hidden" id="dtp_input2" value="" /><br />
									</div>
								</div>
							</fieldset>
						</form>
					</div>

					<!-- <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"> -->
					<form class="dropzone" id="myDropzone">
						<div class="am-text-success dz-message m-auto">

							<h2 style="text-align: center;">拖曳文件<br>或点此打开进行选择</h2>

						</div>
						<input id="date" name='date' value="" style="display: none;" />
						<input id="style" name='style' value="Dam" style="display: none;" />

					</form>
					<!-- </div> -->


					<!-- <button id="submit-all" class="btn blue btn-block">提交 <i class="m-icon-swapright m-icon-white"></i></button> -->

					<button class="btn blue btn-block" data-toggle="modal" id='con' onclick="con"> 提交 <i class="m-icon-swapright m-icon-white"></i></button>

					<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
						<div class="modal-dialog">
							<div class="modal-content">
								<div class="modal-header">
									<h4 class="modal-title" id="myModalLabel">您是否上传这些文件？</h4>
								</div>
								<div class="modal-footer">
									<button type="button" class="btn btn-default" data-dismiss="modal">否，我想再看看</button>
									<button type="button" class="btn btn-primary" data-dismiss="modal" id="submit-all">是，我确定上传</button>
								</div>
							</div><!-- /.modal-content -->
						</div>
					</div>

					<p>

						<span class="label label-important">注意</span>&nbsp;

						点击'成功'按键，即将已上传文件从上传队列中移除

					</p>

				</div>

			</div>

			<!-- END PAGE CONTENT-->

		</div>

		<!-- END PAGE CONTAINER-->

		</div>

		<!-- END PAGE -->

		</div>

		<!-- END CONTAINER -->

		<!-- BEGIN FOOTER -->

		<div class="footer">

			<div class="footer-inner">

				2019 ❤华能浙江能销公司开发❤
			</div>

			<div class="footer-tools">

				<span class="go-top">

					<i class="icon-angle-up"></i>

				</span>

			</div>

		</div>

		<!-- END FOOTER -->

		<!-- BEGIN JAVASCRIPTS(Load javascripts at bottom, this will reduce page load time) -->

		<!-- BEGIN CORE PLUGINS -->

		<script src="media/js/jquery-1.10.1.min.js" type="text/javascript"></script>

		<!--<script src="media/js/jquery-3.1.1.min.js"></script>

		<script src="media/js/jquery-ui-timepicker-addon.min.js"></script>-->

		<!--script src="jQuery-Timepicker/i18n/jquery-ui-timepicker-zh-CN.js" type="text/javascript"></script>

		<!--NEW-->

		<script src="media/js/jquery-migrate-1.2.1.min.js" type="text/javascript"></script>

		<!-- IMPORTANT! Load jquery-ui-1.10.1.custom.min.js before bootstrap.min.js to fix bootstrap tooltip conflict with jquery ui tooltip -->

		<script src="media/js/jquery-ui-1.10.1.custom.min.js" type="text/javascript"></script>

		<script src="media/js/bootstrap.min.js" type="text/javascript"></script>

		<!--<script src="media/js/moment-with-locales.min.js"></script>

		<script src="media/js/bootstrap-datetimepicker.min.js"></script>-->

		<!--[if lt IE 9]>

	<script src="media/js/excanvas.min.js"></script>

	<script src="media/js/respond.min.js"></script>  

	<![endif]-->
		<script type="text/javascript" src="media/js/bootstrap-datepicker.js"></script>

		<script src="media/js/jquery.slimscroll.min.js" type="text/javascript"></script>

		<script src="media/js/jquery.blockui.min.js" type="text/javascript"></script>

		<script src="media/js/jquery.cookie.min.js" type="text/javascript"></script>

		<script src="media/js/jquery.uniform.min.js" type="text/javascript"></script>

		<script src="media/js/jquery.fancybox.pack.js"></script>

		<script type="text/javascript" src="media/js/bootstrap-datepicker.js"></script>

		<!-- END CORE PLUGINS -->

		<!-- BEGIN PAGE LEVEL PLUGINS -->

		<script src="media/js/2.js"></script>


		<script src="media/js/new_file.js"></script>

		<!-- END PAGE LEVEL PLUGINS -->

		<!-- BEGIN PAGE LEVEL SCRIPTS -->

		<script src="media/js/app.js"></script>

		<script src="media/js/search.js"></script>


		<script type="text/javascript" src="jquery/jquery-1.8.3.min.js" charset="UTF-8"></script>
		<script type="text/javascript" src="bootstrap/js/bootstrap.min.js"></script>
		<script type="text/javascript" src="js/bootstrap-datetimepicker.js" charset="UTF-8"></script>
		<script type="text/javascript" src="js/locales/bootstrap-datetimepicker.zh-CN.js" charset="UTF-8"></script>
		<script type="text/javascript">
			$('.form_date').datetimepicker({
				language: 'zh-CN',
				weekStart: 1,
				todayBtn: "linked",
				clearBtn: true,
				autoclose: 1,
				todayHighlight: 1,
				startView: 2,
				minView: 2,
				forceParse: 0
			});
		</script>
	<script type="text/javascript">
		var d = document.getElementById("dtp_input2").value
		Dropzone.autoDiscover = false;
	
		var myDropzone = new Dropzone("#myDropzone", {
			url: "http://127.0.0.1:8080/EleMarket/UploadFile",
			addRemoveLinks: true,
			method: 'post',
			autoProcessQueue: false,
			parallelUploads: true,
			maxFiles: 20,
			autoProcessQueue: false,
			dictMaxFilesExceeded: "您最多只能上传20个文件！",
			dictResponseError: '文件上传失败!',
			dictInvalidFileType: "你不能上传该类型文件,文件类型只能是*.xlsx,.xls。",
			dictFallbackMessage: "浏览器不受支持",
			dictFileTooBig: "文件过大上传文件最大支持.",
			acceptedFiles: ".xlsx,.xls",
			filesizeBase: 1024,
			sending: function(file, xhr, formData) {
				formData.append("filesize", file.size);
			},
			success: function(file, response, e) {
				var res = JSON.parse(response);
				if (res.error) {
					$(file.previewTemplate).children('.dz-error-mark').css('opacity', '1')
				}
			},
			complete: function(file) {
	
				if (file.status == "success") {
					this.processQueue();
				}
				return;
	
			}
	
		});
		myDropzone.on("addedfile", function(file) {
			let name = file.name;
			if (name != undefined) {
				for (let i = 0; i < $('.dz-filename').length - 1; i++) {
					if ($('.dz-filename')[i] == undefined) {
						return;
					}
					let dz = $('.dz-filename')[i];
					console.log(dz.innerHTML);
					let d = dz.innerHTML
					if (d.indexOf(name) != -1) {
						alert("文件名重复，请检查后上传");
						return;
					}
				}
			}
	
		});
		myDropzone.on("success", function(a, b) {
			var m = JSON.parse(b);;
	
			if (m.result != undefined && m.result == "fail") {
				alert(m.msg);
				return;
			}
		});
		var that = $("#submit-all");
		//	function init() {
		var submitButton = document.querySelector("#submit-all")
		//	myDropzone = this;
	
		submitButton.addEventListener("click", function() {
			// alert($(".dz-preview").length);
			//myDropzone.autoProcessQueue=true;
			// for (let i = 0; i < $(".dz-preview").length; i++) {
			myDropzone.processQueue();
	
			// }
	
			//myDropzone.processQueue();
			//console.log(myDropzone);
			//alert($(".dz-preview").length);
	
		});
	
	
	
		that.on("addedfile", function() {
			$("#submit-all").removeAttr("disabled");
		});
		var btn = document.getElementById("con");
		btn.onclick = function() {
			//  alert("你点击了按钮哦！");  
			// data-target="#myModal" 
			if ($(".dz-preview").length == 0) {
				alert("您还没有上传文件！");
				return;
			}
			if (document.getElementById("dtp_input2").value == '') {
				alert("您还没有选择日期！");
				return;
			}
			let date = document.getElementById("dtp_input2").value.toString();
			$("#date").val(date);
			btn.setAttribute("data-target", "#myModal");
	
		}
		// function con(){
		// 	alert(11);
		// 	
		// //	data-target="#myModal"
		// 	return;
		// }
	
	
		//		}
	</script>
			<!-- <script type="text/javascript">
			$('#dtp_input2').datetimepicker({
				onGenerate: function(dateText, inst) {
					console.log(dateText);
					alert($("#dtp_input2").find("input").val());
				}
			});
			//$('#dtp_input2').datetimepicker({
				//onShow: function(dateText, inst) {
				//	alert($("#dtp_input2").find("input").val());
			//	}
			//});
			// $("#dtp_input2").data("dtp_input2").getDate()

			console.log(111)
			console.log($("#dtp_input2").find("input").val())
		</script> -->
		<script>
			jQuery(document).ready(function() {

				// initiate layout and plugins

				App.init();

			});
		</script>

		<!-- END PAGE LEVEL SCRIPTS -->

		<script type="text/javascript">
			var _gaq = _gaq || [];
			_gaq.push(['_setAccount', 'UA-37564768-1']);
			_gaq.push(['_setDomainName', 'keenthemes.com']);
			_gaq.push(['_setAllowLinker', true]);
			_gaq.push(['_trackPageview']);
			(function() {
				var ga = document.createElement('script');
				ga.type = 'text/javascript';
				ga.async = true;
				ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
				var s = document.getElementsByTagName('script')[0];
				s.parentNode.insertBefore(ga, s);
			})();
		</script>
	</body>

	<!-- END BODY -->

</html>
